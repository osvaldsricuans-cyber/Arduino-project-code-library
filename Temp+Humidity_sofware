#include <U8g2lib.h>
#include "DHT.h"

// ----- DHT11 setup -----
#define DHTPIN 2
#define DHTTYPE DHT11
DHT dht(DHTPIN, DHTTYPE);

// ----- OLED setup -----
U8G2_SH1106_128X64_NONAME_F_4W_HW_SPI U8G2(U8G2_R0, /* cs=*/ 10, /* dc=*/ 8, /* reset=*/ 9);

void setup() {
  U8G2.begin();
  dht.begin();
}

void loop() {
  float temp = dht.readTemperature();  // Â°C
  float hum  = dht.readHumidity();     // %

  U8G2.clearBuffer();
  U8G2.setFont(u8g2_font_ncenB08_tr);

  if (!isnan(temp) && !isnan(hum)) {
    U8G2.setCursor(0, 20);
    U8G2.print("Temp: ");
    U8G2.print(temp);
    U8G2.print(" C");

    U8G2.setCursor(0, 40);
    U8G2.print("Hum: ");
    U8G2.print(hum);
    U8G2.print(" %");
  } else {
    U8G2.setCursor(0, 20);
    U8G2.print("Sensor error!");
  }

  U8G2.sendBuffer();
  delay(2000);
}
